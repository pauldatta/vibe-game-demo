### Project: Flappy Merlion

**Objective:** Create a "Flappy Bird" style game using HTML/CSS/JS and the Three.js library. The game will feature the Singapore Merlion as the main character, with keyboard controls, a scoring system, and custom assets generated by Imagen.

---

### Phase 1: Project Setup & Asset Generation

1.  **Create File Structure:** Set up the basic files and folders for the project.
    *   `index.html` (The main game page)
    *   `style.css` (For UI elements like the score and game-over screen)
    *   `game.js` (The core game logic with Three.js)
    *   `plan.md` (This file)
    *   `task.md` (A detailed checklist of tasks)
    *   `assets/images/` (To store the generated game assets)

2.  **Generate Game Assets:** Use the `imagen` tool to create the visual assets for the game.
    *   **Merlion Character:** A cute, 2D sprite of the Merlion.
    *   **Obstacles:** Stylized, futuristic Singaporean buildings to act as pipes.
    *   **Background:** A panoramic image of the Singapore skyline.

### Phase 2: Basic Scene with Three.js

1.  **HTML Setup:** Link the CSS file, the Three.js library, and the `game.js` script in `index.html`.
2.  **Initialize Three.js:** In `game.js`, set up the fundamental Three.js components:
    *   Scene: The container for all game objects.
    *   Camera: The player's viewpoint (we'll use an OrthographicCamera for a 2D perspective).
    *   Renderer: The engine that draws the scene onto the HTML canvas.
3.  **Add Objects:**
    *   Create a scrolling background using the generated skyline image.
    *   Add the Merlion sprite to the center of the scene.

### Phase 3: Player Mechanics

1.  **Keyboard Input:** Listen for the `Spacebar` key press.
2.  **Physics:**
    *   Implement a constant downward force (gravity) that affects the Merlion.
    *   On spacebar press, apply a sharp upward force to the Merlion to make it "flap".
    *   Prevent the Merlion from going off the top or bottom of the screen.

### Phase 4: Obstacles and Gameplay Loop

1.  **Obstacle Generation:**
    *   Create a function that spawns pairs of building obstacles with a consistent vertical gap between them.
    *   The position of the gap will be randomized for each new pair.
2.  **Movement:**
    *   In the main game loop, move the obstacles from right to left across the screen.
    *   Remove obstacles once they go off-screen and spawn new ones to create an endless effect.

### Phase 5: Scoring and Collision Detection

1.  **Collision Logic:**
    *   Implement bounding box collision detection.
    *   Check for collisions between the Merlion and the building obstacles.
    *   Check for collisions between the Merlion and the ground.
2.  **Scoring:**
    *   Increment the player's score each time they successfully pass through an obstacle pair.
    *   Display the score on the screen using an HTML element overlaid on the canvas.

### Phase 6: Game State and UI

1.  **Game States:** Implement a simple state machine to manage the game's flow:
    *   `StartScreen`: Initial screen, waits for the first key press.
    *   `Playing`: The main game is active.
    *   `GameOver`: Displayed after a collision, showing the final score.
2.  **UI Elements:**
    *   Create a "Game Over" message and a "Restart" button that appears when the game ends.
    *   The restart button will reset the game to its initial state.
